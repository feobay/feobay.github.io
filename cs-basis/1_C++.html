<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C++ | FeoBay的个人博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="https://feobay.oss-cn-shanghai.aliyuncs.com/img/terminal.svg">
    <meta name="description" content="Just for fun">
    
    <link rel="preload" href="/assets/css/0.styles.6d920bc0.css" as="style"><link rel="preload" href="/assets/js/app.72c8bf2a.js" as="script"><link rel="preload" href="/assets/js/2.2702b4bf.js" as="script"><link rel="preload" href="/assets/js/13.b6a9667b.js" as="script"><link rel="prefetch" href="/assets/js/10.a94df392.js"><link rel="prefetch" href="/assets/js/11.632e5645.js"><link rel="prefetch" href="/assets/js/12.55b415ad.js"><link rel="prefetch" href="/assets/js/14.9fa2841e.js"><link rel="prefetch" href="/assets/js/15.db6a460d.js"><link rel="prefetch" href="/assets/js/16.051721e3.js"><link rel="prefetch" href="/assets/js/17.1a82dfdf.js"><link rel="prefetch" href="/assets/js/18.b3fd6f3e.js"><link rel="prefetch" href="/assets/js/19.013ce65f.js"><link rel="prefetch" href="/assets/js/20.c1c40422.js"><link rel="prefetch" href="/assets/js/21.a2cce3e9.js"><link rel="prefetch" href="/assets/js/3.3c9c7e39.js"><link rel="prefetch" href="/assets/js/4.d25869ab.js"><link rel="prefetch" href="/assets/js/5.1840f9a3.js"><link rel="prefetch" href="/assets/js/6.03bfa775.js"><link rel="prefetch" href="/assets/js/7.368f46d5.js"><link rel="prefetch" href="/assets/js/8.e438b600.js"><link rel="prefetch" href="/assets/js/9.39ebbd5e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6d920bc0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/terminal.svg" alt="FeoBay的个人博客" class="logo"> <span class="site-name can-hide">FeoBay的个人博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/cs-basis/" class="nav-link router-link-active">
  计算机基础
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法刷题
</a></div><div class="nav-item"><a href="/notes/" class="nav-link">
  随记
</a></div><div class="nav-item"><a href="https://github.com/feobay" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/cs-basis/" class="nav-link router-link-active">
  计算机基础
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  算法刷题
</a></div><div class="nav-item"><a href="/notes/" class="nav-link">
  随记
</a></div><div class="nav-item"><a href="https://github.com/feobay" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/cs-basis/" aria-current="page" class="sidebar-link">计算机基础</a></li><li><a href="/cs-basis/1_C++.html" aria-current="page" class="active sidebar-link">C++</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#c-基础" class="sidebar-link">C++基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#前置知识" class="sidebar-link">前置知识</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_1-内存分区模型" class="sidebar-link">1 内存分区模型</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_2-c-中的引用" class="sidebar-link">2 C++中的引用</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_3-面向对象" class="sidebar-link">3 面向对象</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_3-1-封装" class="sidebar-link" style="padding-left:3rem;">3.1 封装</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_3-2-对象的初始化和清理" class="sidebar-link" style="padding-left:3rem;">3.2 对象的初始化和清理</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#" class="sidebar-link" style="padding-left:3rem;"></a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_3-4-友元" class="sidebar-link" style="padding-left:3rem;">3.4 友元</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_3-5-运算符重载" class="sidebar-link" style="padding-left:3rem;">3.5 运算符重载</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_3-6-继承" class="sidebar-link" style="padding-left:3rem;">3.6 继承</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_3-7-多态" class="sidebar-link" style="padding-left:3rem;">3.7 多态</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_4-函数提高" class="sidebar-link">4 函数提高</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_4-1-函数默认参数" class="sidebar-link" style="padding-left:3rem;">4.1 函数默认参数</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_4-2-函数的占位参数" class="sidebar-link" style="padding-left:3rem;">4.2 函数的占位参数</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_4-3-函数重载" class="sidebar-link" style="padding-left:3rem;">4.3 函数重载</a></li></ul></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#c-primer部分内容" class="sidebar-link">C++Primer部分内容</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_5-顺序容器" class="sidebar-link">5 顺序容器</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#_5-1-额外的string操作" class="sidebar-link" style="padding-left:3rem;">5.1 额外的string操作</a></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#io库" class="sidebar-link">IO库</a></li></ul></li><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#补充" class="sidebar-link">补充</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/cs-basis/1_C++.html#关于extern关键字" class="sidebar-link">关于extern关键字</a></li></ul></li></ul></li><li><a href="/cs-basis/2_EffectiveC++.html" class="sidebar-link">EffectiveC++</a></li><li><a href="/cs-basis/3_STL源码剖析.html" class="sidebar-link">STL源码剖析（侯捷）</a></li><li><a href="/cs-basis/4_ComputerNetwork.html" class="sidebar-link">计算机网络</a></li><li><a href="/cs-basis/5_操作系统.html" class="sidebar-link">操作系统</a></li><li><a href="/cs-basis/6_计算机体系结构.html" class="sidebar-link">计算机体系结构</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="c"><a href="#c" class="header-anchor">#</a> C++</h1> <h2 id="c-基础"><a href="#c-基础" class="header-anchor">#</a> C++基础</h2> <h3 id="前置知识"><a href="#前置知识" class="header-anchor">#</a> 前置知识</h3> <p>编译过程</p> <p><img src="https://www3.ntu.edu.sg/home/ehchua/programming/cpp/images/GCC_CompilationProcess.png" alt="avatar"></p> <p><strong>1.预处理命令(Preprocessing)</strong></p> <p>==将.cpp文件转化为.i文件==</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>预处理器cpp命令：cpp <span class="token operator">-</span>o test<span class="token punctuation">.</span>i test<span class="token punctuation">.</span>cpp
gcc<span class="token operator">/</span>g<span class="token operator">++</span>命令： gcc <span class="token operator">-</span>E test<span class="token punctuation">.</span>c <span class="token operator">-</span>o test<span class="token punctuation">.</span>i
</code></pre></div><blockquote><p>这一步预处理把所有include的文件（包括递归包含的文件）的内容都展开到输出文件中，并展开了所有的宏定义。</p></blockquote> <p>对于其中的伪指令（以#开头的指令）和特殊符号进行处理。</p> <p>伪指令主要包括以下四个方面：</p> <p>1)宏定义指令，如 <code>#define Name TokenString #undef</code> 等</p> <p>对于一个伪指令，预编译所要做的事情就是将程序中的所有Name用TokenString替换，但是作为字符串常量的Name则不被替换。对于后者，则将取消对某个宏的定义，使得以后该串再次出现时不会被替换。</p> <p>2)条件编译指令，</p> <p><strong>2. 编译(Compilation)</strong></p> <p>==将.cpp/.h文件转换成.s文件==</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>编译命令cc<span class="token operator">:</span> cc test<span class="token punctuation">.</span>i <span class="token operator">-</span>o test<span class="token punctuation">.</span>s
gcc<span class="token operator">/</span>g<span class="token operator">++</span>命令<span class="token operator">:</span> gcc <span class="token operator">-</span>S test<span class="token punctuation">.</span>i <span class="token operator">-</span>o test<span class="token punctuation">.</span>s
</code></pre></div><p>编译的过程将预处理完的文件进行一系列的词法分析，语法分析，语义分析及优化集成相应的汇编代码。在这一步中一般会进行优化，比如去除没有用到的类的声明，循环语句的优化等。</p> <p><strong>3.汇编(Assemble)</strong></p> <p>==将.s文件转化成.o文件==</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>汇编命令<span class="token operator">:</span> as test<span class="token punctuation">.</span>s <span class="token operator">-</span>o test<span class="token punctuation">.</span>o
gcc<span class="token operator">/</span>g<span class="token operator">++</span><span class="token operator">:</span> gcc <span class="token operator">-</span>c test<span class="token punctuation">.</span>s <span class="token operator">-</span>o test<span class="token punctuation">.</span>o
</code></pre></div><p>as汇编器，会把汇编代码转换成机器指令，并以特定二进制格式输出保存在目标文件中。</p> <p><strong>4.链接(Linking)</strong></p> <p>==将.o文件转化成可执行程序==</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>链接命令ld<span class="token operator">:</span> ld test<span class="token punctuation">.</span>o <span class="token operator">-</span>o test
gcc<span class="token operator">/</span>g<span class="token operator">++</span>命令<span class="token operator">:</span> gcc test<span class="token punctuation">.</span>c
</code></pre></div><p>ld链接器，把程序的相关目标文件组合链接在一起，生成程序的可执行映像文件，该文件还不能直接执行，还有很多问题需要解决。</p> <p>第一步要解决的问题是：可能调用到了库函数，或者目标文件中调用到了另外一个源文件中定义的某个符号（如变量或者函数调用等），需要通过链接器建立对应的关系，使得程序能够正常的执行。</p> <p><strong>链接方式</strong></p> <p>1.<strong>静态链接：</strong></p> <p>将源代码从静态库中拷贝到最终的可执行程序中。这样可能会导致最终的目标文件很大。</p> <p>2.<strong>动态链接：</strong></p> <p>需要调用的库函数以动态链接库的形式存在，多个进程之间共享。而链接的时候只需要直到调用的函数的位置即可。在程序执行时，当需要调用某个动态链接库中的函数时，操作系统首先会查找所有正在运行的程序，看内存中是否已经有该函数的拷贝了。如果用，则多个进程共享该拷贝。否则才会将其载入到该进程的虚拟内存中。</p> <h3 id="_1-内存分区模型"><a href="#_1-内存分区模型" class="header-anchor">#</a> 1 内存分区模型</h3> <img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220305165019456.png" alt="image-20220305165019456" style="zoom:40%;"> <p>C++程序执行时，将内存分为<strong>4个区域</strong></p> <ul><li>代码区：存放函数体的二进制代码，由操作系统进行管理。（函数定义类定义等逻辑二进制代码在代码区）</li> <li>常量区：存放常量字符串，程序结束后由系统释放。</li> <li>全局区：存放全局数据、静态变量 和 常量（上图全局区为静态全局区）bss和data</li> <li>堆区：由程序员分配和释放，若程序员不释放，程序结束时由操作系统回收</li> <li>栈区：由编译器自动分配释放，存放函数的参数值，局部变量等</li></ul> <img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220305165845411.png" alt="image-20220305165845411" style="zoom:40%;"> <p>placement new：分配内存时，先将内存分配出来，再在这个地址的某一个地方对它进行分配</p> <p><strong>1.1 程序执行前</strong></p> <p>在程序编译后，生成了exe可执行程序，未执行程序前分为两个区域</p> <p><strong>代码区：</strong></p> <p>​		存放CPU执行的机器指令</p> <p>​		代码区是<strong>共享</strong>的，共享的目的是对于频繁被执行的程序，只需要在内存中有一份代码即可。</p> <p>​		代码区是<strong>只读</strong>的，使其只读的原因是防止程序意外地修改了它的指令。</p> <p><strong>全局区：</strong></p> <p>​		全局变量和静态变量存放于此。</p> <p>​		全局区还包含了常量区，字符串常量和其它常量都存放于此。</p> <p>​		该区域的数据在程序结束后由操作系统释放。</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//全局变量</span>
<span class="token keyword">int</span> g_a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> g_b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">//全局常量</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> c_g_a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//全局区</span>
    <span class="token comment">//全局变量，静态变量，常量</span>

    <span class="token comment">//创建局部变量, 只要在函数体内声明的非常量、非静态变量均为局部变量（const修饰的局部常量也是局部变量</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;局部变量a的地址：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;局部变量b的地址：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;全局变量g_a的地址：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>g_a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;全局变量g_b的地址：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>g_b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token comment">//创建静态变量 普通变量前加上static均为静态变量</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> s_a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> s_b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;静态变量s_a的地址：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>s_a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;静态变量s_b的地址：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>s_b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token comment">//常量 </span>
    <span class="token comment">//字符串常量，&quot;&quot;括起来的就是字符串常量</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;字符串常量\&quot;hello world\&quot;的地址：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span><span class="token string">&quot;hello world&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token comment">//const修饰变量</span>
    <span class="token comment">//const修饰的全局常量</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;const修饰全局常量c_g_a的地址：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>c_g_a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token comment">//const修饰的局部常量</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> c_a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;const修饰局部常量c_a的地址：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>c_a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>栈区：</strong></p> <p>由编译器自动分配释放，存放函数的参数值，局部变量等</p> <p>栈区注意事项：</p> <ol><li><p>函数中一般不要返回局部变量地址</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token operator">*</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//局部变量，存放于栈区，在函数结束后被系统自动回收</span>
    <span class="token keyword">return</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span> <span class="token comment">//返回局部变量地址</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">// 有些编译器第一次可以输出正常数字，是因为编译器做了保留</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">// 第二次这个数据就不再保留了</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <p>堆区：</p> <p>​		全局变量在堆区，且默认初始化为0</p> <p>​		C++中主要用new来开辟空间：</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token operator">*</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//利用new关键字将数据开辟到堆区</span>
    <span class="token comment">//指针p本质上也是局部变量，放在栈上，指针保存的数据存放于堆上</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> p<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">delete</span> p<span class="token punctuation">;</span>
    <span class="token comment">//cout &lt;&lt; *p &lt;&lt; endl; //内存已被释放，再次访问是非法操作，会报错或乱码</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">delete</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//test01();</span>
    <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_2-c-中的引用"><a href="#_2-c-中的引用" class="header-anchor">#</a> 2 C++中的引用</h3> <p><strong>基本语法：</strong><code>数据类型 &amp;别名 = 原名</code></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token operator">&amp;</span>b <span class="token operator">=</span> a<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;a = &quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;b = &quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;&amp;a = &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;&amp;b = &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">&amp;</span>b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    b <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;a = &quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;b = &quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>注意事项：</strong></p> <ul><li>引用必须初始化</li> <li>引用一旦初始化，就不可以修改</li></ul> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token comment">//1.引用必须初始化</span>
    <span class="token comment">//int &amp;b;</span>
    <span class="token keyword">int</span> <span class="token operator">&amp;</span>b <span class="token operator">=</span> a<span class="token punctuation">;</span>
    
    <span class="token comment">//2.引用初始化后，不可以改变</span>
    <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    b <span class="token operator">=</span> c<span class="token punctuation">;</span> <span class="token comment">//赋值操作，而不是更改引用</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;a = &quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;b = &quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;c = &quot;</span> <span class="token operator">&lt;&lt;</span> c <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>引用做函数参数:</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//交换函数</span>

<span class="token comment">//1.值传递(不成功)</span>
<span class="token keyword">void</span> <span class="token function">swap1</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp <span class="token operator">=</span> a<span class="token punctuation">;</span>
    a <span class="token operator">=</span> b<span class="token punctuation">;</span>
    b <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//2.地址传递(成功)</span>
<span class="token keyword">void</span> <span class="token function">swap2</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>a<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token operator">*</span>a<span class="token punctuation">;</span>
    <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token operator">*</span>b<span class="token punctuation">;</span>
    <span class="token operator">*</span>b <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//3.引用传递(成功)</span>
<span class="token keyword">void</span> <span class="token function">swap3</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp <span class="token operator">=</span> a<span class="token punctuation">;</span>
    a <span class="token operator">=</span> b<span class="token punctuation">;</span>
    b <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token function">swap1</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;值传递：&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;a = &quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;b = &quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token function">swap2</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;地址传递：&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;a = &quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;b = &quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token function">swap3</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;引用传递：&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;a = &quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;b = &quot;</span> <span class="token operator">&lt;&lt;</span> b <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>引用作为函数的返回值：</strong></p> <ul><li>不要返回局部变量的引用</li> <li>函数的调用可以作为左值</li></ul> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//引用作为函数的返回值</span>

<span class="token comment">//1.不要返回局部变量的引用</span>
<span class="token comment">// int&amp; test01() {</span>
<span class="token comment">//     int a = 10; //局部变量存放于栈区</span>
<span class="token comment">//     return a;</span>
<span class="token comment">// }</span>

<span class="token comment">//2.函数的调用可以作为左值</span>
<span class="token keyword">int</span><span class="token operator">&amp;</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//静态变量，存放于全局区，全局区的数据程序执行结束后系统释放</span>
    <span class="token keyword">return</span> a<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//int &amp;ref = test01();</span>
    <span class="token comment">//cout &lt;&lt; &quot;ref = &quot; &lt;&lt; ref &lt;&lt; endl; //非法操作有的编译器第一次会做保留</span>
    <span class="token comment">//cout &lt;&lt; &quot;ref = &quot; &lt;&lt; ref &lt;&lt; endl; //第一次保留的编译器第二次会释放</span>
    <span class="token keyword">int</span> <span class="token operator">&amp;</span>ref2 <span class="token operator">=</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ref2 = &quot;</span> <span class="token operator">&lt;&lt;</span> ref2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ref2 = &quot;</span> <span class="token operator">&lt;&lt;</span> ref2 <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token comment">//返回值为引用的函数，函数调用可作为左值</span>
    <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ref2 = &quot;</span> <span class="token operator">&lt;&lt;</span> ref2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ref2 = &quot;</span> <span class="token operator">&lt;&lt;</span> ref2 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>引用的本质：</strong></p> <p>本质：<strong>引用的本质在C++内部实现是一个指针常量</strong></p> <p>指针常量就是指针指向的地址不变</p> <p>常量指针就是指针指向的地址存的值不变</p> <p><code>int* const ref = &amp;a;</code></p> <p><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220130232440873-16435562836072.png" alt="image-20220130232440873"></p> <p><strong>常量引用</strong></p> <p>作用：<strong>用来修饰形参，防止误操作</strong></p> <p><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220130233117917-16435566800883.png" alt="image-20220130233117917"></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//常量引用</span>
<span class="token comment">//使用场景：用来修饰形参，防止误操作</span>

<span class="token keyword">void</span> <span class="token function">showValue</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//val = 1000;//不允许修改</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;val = &quot;</span> <span class="token operator">&lt;&lt;</span> val <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//int a = 10;</span>
    <span class="token comment">//加上cosnt之后 编译器将代码修改 int temp = 10; const int &amp;ref = temp;</span>
    <span class="token comment">//const int &amp;ref = 10; //引用必须引用一块合法的内存空间</span>
    <span class="token comment">//ref = 20;//加入const之后只读不允许修改</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token function">showValue</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-面向对象"><a href="#_3-面向对象" class="header-anchor">#</a> 3 面向对象</h3> <h4 id="_3-1-封装"><a href="#_3-1-封装" class="header-anchor">#</a> 3.1 封装</h4> <p><strong>访问权限</strong></p> <p>公共权限 public		成员 类内可以访问 类外可以访问</p> <p>保护权限 protected 成员 类内可以访问 类外不可访问 儿子可以访问父亲中的保护内容</p> <p>私有权限 private	  成员 类内可以访问 类外不可访问 儿子不可以访问父亲中的私有内容</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    string m_name<span class="token punctuation">;</span>

<span class="token keyword">protected</span><span class="token operator">:</span>
    string m_Car<span class="token punctuation">;</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_passwd<span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_name <span class="token operator">=</span> <span class="token string">&quot;张三&quot;</span><span class="token punctuation">;</span>
        m_Car <span class="token operator">=</span> <span class="token string">&quot;拖拉机&quot;</span><span class="token punctuation">;</span>
        m_passwd <span class="token operator">=</span> <span class="token number">123456</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p1<span class="token punctuation">;</span>
    p1<span class="token punctuation">.</span>m_name <span class="token operator">=</span> <span class="token string">&quot;李四&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//p1.m_Car = &quot;法拉利&quot;; //类外不可访问</span>
    <span class="token comment">//p1.m_passwd = &quot;654321&quot;; //类外不可访问</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>struct与class区别</strong></p> <p>struct默认权限是公共</p> <p>class默认权限是私有</p> <p><strong>成员属性设置为私有优缺点</strong></p> <p>**优点1：**可以自己控制读写权限</p> <p>**优点2：**对于写权限，可以检测数据的有效性</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//姓名 可读可写</span>
    <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//设置姓名接口</span>
        m_Name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    string <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//获取姓名</span>
        <span class="token keyword">return</span> m_Name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//年龄 可读可写 写需限制有效性</span>
    <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>age <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> age <span class="token operator">&gt;</span> <span class="token number">150</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            m_Age <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;您设置的年龄不合法，请重新设置！&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        m_Age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//获取年龄</span>
        <span class="token keyword">return</span> m_Age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//情人只写</span>
    <span class="token keyword">void</span> <span class="token function">setLover</span><span class="token punctuation">(</span>string lover<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//设置Lover</span>
        m_Lover <span class="token operator">=</span> lover<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    string m_Name<span class="token punctuation">;</span> <span class="token comment">//姓名 可读可写</span>
    <span class="token keyword">int</span> m_Age <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//年龄 可读可写 写需限制有效性</span>
    string m_Lover<span class="token punctuation">;</span> <span class="token comment">//只写</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p<span class="token punctuation">;</span>
    p<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;张三的姓名为：&quot;</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    p<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;张三的年龄为：&quot;</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    p<span class="token punctuation">.</span><span class="token function">setLover</span><span class="token punctuation">(</span><span class="token string">&quot;仓井&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//情人不可被别人获取</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-2-对象的初始化和清理"><a href="#_3-2-对象的初始化和清理" class="header-anchor">#</a> 3.2 对象的初始化和清理</h4> <p><strong>3.2.1构造函数和析构函数</strong></p> <ul><li>构造函数：创建对象时为对象的成员属性赋值，构造函数由编译器自动调用，无需手动调用。</li> <li>析构函数：对象销毁前系统自动调用，执行清理工作。</li> <li>构造函数与析构函数都是必须有的，如果代码中没有，那么编译器会自动提供一个空的构造和析构。</li></ul> <p><strong>构造函数语法：</strong><code>类名(){}</code></p> <p>1.构造函数没有返回值也不写void</p> <p>2.函数名称与类名相同</p> <p>3.构造函数可以有参数，因此可以发生重载</p> <p>4.程序在调用对象时会自动构造，无需手动调用，而且只会调用一次。</p> <p><strong>析构函数语法：</strong><code>~类名(){}</code></p> <p>1.构造函数没有返回值也不写void</p> <p>2.函数名称与类名相同，在名称前加上~</p> <p>3.构造函数不可以有参数，因此不可以发生重载</p> <p>4.程序在调用对象销毁前会自动析构，无需手动调用，而且只会调用一次。</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person析构函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p<span class="token punctuation">;</span><span class="token comment">//栈上的数据，test01()执行完毕后，释放这个对象</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Person p<span class="token punctuation">;</span><span class="token comment">//在整个程序结束时会自动销毁，所以程序结束才会调用析构函数</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">/*
运行结果：
Person函数调用
Person析构函数调用
Person函数调用
请按任意键继续. . . 
Person析构函数调用
*/</span>
</code></pre></div><p><strong>3.2.2构造函数的分类及调用</strong></p> <p>两种分类方式</p> <p>​		按参数分为：有参数构造和无参构造（无参也叫默认构造函数）</p> <p>​		按类型分为：普通构造和拷贝构造</p> <p>三种调用方式</p> <p>​		括号法</p> <p>​				注意事项：调用默认构造函数时不要加()</p> <p>​				Person p1(); // 不会创建对象，编译器会认为其为一个函数的声明，不会认为是对象</p> <p>​		显示法</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>Person p1<span class="token punctuation">;</span>
Person p2 <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Person p3 <span class="token operator">=</span> <span class="token function">p2</span><span class="token punctuation">(</span>p3<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//匿名对象，特点：当前执行结束后，系统会立即回收掉匿名对象</span>
cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;aaaa&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

<span class="token comment">//注意事项2：不要利用拷贝构造函数初始化匿名对象 编译器会认为 Person (p3) == Perosn p3;</span>
<span class="token function">Person</span><span class="token punctuation">(</span>p3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//报错显示&quot;Person p3&quot;重定义，编译器认为是一个声明语句</span>
</code></pre></div><p>​		隐式转换法</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>Person p4 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//相当于 写了 Person p4 = Person(10); //有参构造</span>
Person p5 <span class="token operator">=</span> p4<span class="token punctuation">;</span> <span class="token comment">//拷贝构造</span>
<span class="token comment">//仅能调用只有一个参数的拷贝构造函数</span>
</code></pre></div><p>​</p> <p><strong>3.2.3构造函数的调用时机</strong></p> <p>三种情况</p> <ul><li>使用一个已经创建完毕的对象来初始化一个新对象</li> <li>值传递的方式给函数参数传值</li> <li>以值返回局部对象（注意第三种受编译器影响各不相同）</li></ul> <p>（值传递的本质上拷贝出一个临时副本）</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_Age<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person的默认构造函数参数&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person的析构函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> Age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person的有参构造函数参数&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        m_Age <span class="token operator">=</span> Age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> Person <span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person的拷贝构造函数参数&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        m_Age <span class="token operator">=</span> p<span class="token punctuation">.</span>m_Age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//1.使用一个已经创建完毕的对象来初始化一个新对象</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Person <span class="token function">p2</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//2.值传递的方式给函数参数传值</span>
<span class="token keyword">void</span> <span class="token function">doWork</span><span class="token punctuation">(</span>Person p<span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p<span class="token punctuation">;</span>
    <span class="token function">doWork</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//值传递的本质上拷贝出一个临时副本,所以传值时会调用拷贝构造函数</span>
<span class="token punctuation">}</span>

<span class="token comment">//3.以值返回局部对象</span>
<span class="token comment">//第三点根据编译器不同会发生变化</span>
Person <span class="token function">doWork2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p1<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>p1 <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> p1<span class="token punctuation">;</span><span class="token comment">//返回是返回的值，而不是p1这个局部对象本体,它会拷贝一个新的对象返回</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p <span class="token operator">=</span> <span class="token function">doWork2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//test01();</span>
    <span class="token comment">//test02();</span>
    <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.2.4构造函数调用规则</strong></p> <p>默认情况下，C++编译器至少给一个类添加3个函数</p> <ol><li>默认构造函数（无参，函数体为空）</li> <li>默认析构函数（无参，函数体为空）</li> <li>默认拷贝构造函数，对属性进行<strong>值拷贝</strong></li></ol> <p>构造函数调用规则如下：</p> <ul><li>如果用户定义有参构造函数，C++不再提供默认无参构造，但是会提供默认拷贝构造(值拷贝)</li> <li>如果用户定义拷贝构造函数，C++不会再提供其他默认构造函数</li></ul> <p><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220220231921108.png" alt="image-20220220231921108"></p> <p>示例：</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_Age<span class="token punctuation">;</span>
    <span class="token comment">// Person() {</span>
    <span class="token comment">//     cout &lt;&lt; &quot;Person的默认构造函数&quot; &lt;&lt; endl;</span>
    <span class="token comment">// }</span>
    <span class="token comment">// Person (int age) {</span>
    <span class="token comment">//     cout &lt;&lt; &quot;Person的有参构造函数调用&quot; &lt;&lt; endl;</span>
    <span class="token comment">//     m_Age = age;</span>
    <span class="token comment">// }</span>
    <span class="token function">Person</span> <span class="token punctuation">(</span><span class="token keyword">const</span> Person <span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person的拷贝构造函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        m_Age <span class="token operator">=</span> p<span class="token punctuation">.</span>m_Age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person的析构函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// void test01() {</span>
<span class="token comment">//     Person p;</span>
<span class="token comment">//     p.m_Age = 18;</span>
<span class="token comment">//     Person p2(p);</span>
<span class="token comment">//     cout &lt;&lt; &quot;p2的年龄为：&quot; &lt;&lt; p2.m_Age &lt;&lt; endl;</span>
<span class="token comment">// }</span>

<span class="token comment">// void test02() {</span>
<span class="token comment">//     Person p(28);</span>
<span class="token comment">//     Person p2(p);</span>
<span class="token comment">//     cout &lt;&lt; &quot;p2的年龄为：&quot; &lt;&lt; p2.m_Age &lt;&lt; endl;</span>
<span class="token comment">// }</span>

<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p<span class="token punctuation">;</span><span class="token comment">//仅写拷贝构造函数时会显示不存在默认拷贝构造函数</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// test01();</span>
    <span class="token comment">// test02();</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">&quot;pause&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.2.5深拷贝与浅拷贝</strong></p> <p>浅拷贝：简单赋值拷贝操作</p> <p>深拷贝：在堆区重新申请空间，进行拷贝操作</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//深拷贝浅拷贝</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_Age<span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>m_Height<span class="token punctuation">;</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person的默认构造函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_Age <span class="token operator">=</span> age<span class="token punctuation">;</span>
        m_Height <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person的有参构造函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//浅拷贝赋值，导致指针指向同一地址，析构时会出现重复释放</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">const</span> Person <span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//若自己不定义，那么系统会提供一个浅拷贝构造函数</span>
        m_Age <span class="token operator">=</span> p<span class="token punctuation">.</span>m_Age<span class="token punctuation">;</span>
        <span class="token comment">//m_Height = p.m_Height; //编译器默认实现的是这行代码</span>
        <span class="token comment">//深拷贝</span>
        m_Height <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">.</span>m_Height<span class="token punctuation">)</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person的拷贝构造建函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//析构函数，释放在堆区开辟的内存</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>m_Height <span class="token operator">!=</span> <span class="token keyword">nullptr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">delete</span> m_Height<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person的析构函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p1的年龄为：&quot;</span> <span class="token operator">&lt;&lt;</span> p1<span class="token punctuation">.</span>m_Age <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;身高为：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span><span class="token punctuation">(</span>p1<span class="token punctuation">.</span>m_Height<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    Person <span class="token function">p2</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p2的年龄为：&quot;</span> <span class="token operator">&lt;&lt;</span> p2<span class="token punctuation">.</span>m_Age <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;身高为：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>m_Height<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>总结：如果属性有在堆区开辟，一定要自己提供拷贝构造函数，防止浅拷贝带来的问题。</p></blockquote> <p><strong>3.2.6初始化列表</strong></p> <p>**作用：**C++提供了初始化列表语法，用来初始化属性。</p> <p><strong>语法：</strong><code>构造函数(): 属性1(值1), 属性2(值2), ... {}</code></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">// 传统的有参构造函数</span>
    <span class="token comment">// Person (int a, int b, int c) {</span>
    <span class="token comment">//     m_A = a;</span>
    <span class="token comment">//     m_B = b;</span>
    <span class="token comment">//     m_C = c;</span>
    <span class="token comment">// }</span>

    <span class="token comment">//初始化列表初始化属性</span>
    <span class="token comment">// Person(): m_A(10), m_B(20), m_C(30){</span>

    <span class="token comment">// }</span>
    <span class="token comment">//也可以</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_A</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_B</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_C</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">printPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p.m_A = &quot;</span> <span class="token operator">&lt;&lt;</span> m_A <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p.m_B = &quot;</span> <span class="token operator">&lt;&lt;</span> m_B <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    	cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p.m_C = &quot;</span> <span class="token operator">&lt;&lt;</span> m_C <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_A<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_B<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_C<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Person p(10, 20, 30);</span>
    <span class="token comment">// Person p;</span>
    Person <span class="token function">p</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    p<span class="token punctuation">.</span><span class="token function">printPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.2.7类对象作为类成员</strong></p> <p>C++类中的成员可以是另一个类的对象，我们称该成员为对象成员。</p> <p>例如：</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token punctuation">{</span>
    A a<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>B类中有对象A作为成员，A为对象成员。</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Phone</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Phone</span><span class="token punctuation">(</span>string pName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_pName <span class="token operator">=</span> pName<span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Phone构造函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">Phone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Phone析构函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    string m_pName<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//Phone m_Phone = pName; //隐式转换法</span>
    <span class="token function">Person</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> string pName<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_Name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_Phone</span><span class="token punctuation">(</span>pName<span class="token punctuation">)</span><span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person构造函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person析构函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    string m_Name<span class="token punctuation">;</span>
    Phone m_Phone<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//当其他类对象作为本类成员，先构造其他类对象，再构造自身</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person <span class="token function">p</span><span class="token punctuation">(</span><span class="token string">&quot;张三&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;苹果MAX&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>m_Name <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;拿着&quot;</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>m_Phone<span class="token punctuation">.</span>m_pName <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>那么当创建B对象时，A与B的构造和析构顺序是谁先谁后？</p> <p>**答：**先构造成员类，再构造自身；先析构自身，再析构成员类。先制造零件，再组装机器人；先拆解机器人，再烧毁零件。</p> <p><strong>3.2.8静态成员</strong></p> <p>静态成员就是在成员变量和成员函数前加上关键字static，称为静态成员，注意静态成员也有访问权限</p> <p>静态成员分为：</p> <ul><li>静态成员变量
<ul><li>所有对象共享同一份数据</li> <li>在编译阶段分配内存</li> <li>类内声明，类外初始化</li></ul></li> <li>静态成员函数
<ul><li>所有对象共享一个函数</li> <li>静态成员函数只能访问静态变量</li></ul></li></ul> <p>**示例：**静态成员变量和静态成员函数</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code> <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> m<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;静态成员变量 m = &quot;</span> <span class="token operator">&lt;&lt;</span> m <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;静态成员函数func调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        m<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//静态成员函数也有权限</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//静态成员变量类内声明，类外初始化</span>
<span class="token keyword">int</span> Person<span class="token double-colon punctuation">::</span>m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">//静态成员函数不需要创建对象也可以访问</span>
<span class="token comment">//静态成员函数，不可以访问非静态成员变量</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//Person::func2(); //类外访问不到私有成员函数</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p1<span class="token punctuation">;</span>
    Person p2<span class="token punctuation">;</span>
    Person<span class="token double-colon punctuation">::</span>m<span class="token operator">++</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;m = &quot;</span> <span class="token operator">&lt;&lt;</span> p1<span class="token punctuation">.</span>m <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    p1<span class="token punctuation">.</span>m<span class="token operator">++</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;m = &quot;</span> <span class="token operator">&lt;&lt;</span> p2<span class="token punctuation">.</span>m <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>静态函数只能访问静态成员，静态成员不需要创建对象也可以被使用</p></blockquote> <h4 id=""><a href="#" class="header-anchor">#</a></h4> <p>3.3 C++对象模型和this指针</p> <p><strong>3.3.1 成员变量和成员函数分开存储</strong></p> <p>在C++中，类内的成员变量和成员函数分开存储。</p> <p><strong>总结：<strong>只有</strong>非静态成员变量</strong>才属于类的对象上</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//成员变量 和 成员函数 是 分开存储的</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> m_A<span class="token punctuation">;</span> <span class="token comment">// 非静态成员变量 属于类的对象上</span>
    <span class="token keyword">long</span> m_B<span class="token punctuation">;</span>
    <span class="token keyword">long</span> <span class="token keyword">long</span> m_C<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> b<span class="token punctuation">;</span> <span class="token comment">//静态成员变量 不属于类的对象上</span>
    <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 非静态成员函数 不属于类对象上</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//静态成员函数 不属于类的对象上</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span> 


<span class="token comment">//空对象占用的内存空间字节为： 1</span>
<span class="token comment">//C++编译器会给每个空对象也分配一个字节空间，是为了区分空对象占内存的位置</span>
<span class="token comment">//每个空对象也应该有一个独一无二的内存地址</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;size of p = &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//若对象非空，则按照占内存最大的非静态成员变量的字节大小来分配内存</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;size of p = &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>C++类满足内存对齐。</p> <p><strong>3.3.2 this指针的用途</strong></p> <p>通过上一节得知，C++中成员变量和成员函数分开存储</p> <p>每一个非静态成员函数只会诞生一份函数实例，也就是说多个同类型的对象会共用同一块代码</p> <p>那么问题是：这一块代码是如何区分那个对象调用自己的呢？</p> <p>C++通过提供特殊的对象指针，this指针，解决上述问题。<strong>this指针指向被调用的成员函数所属的对象</strong></p> <p>this指针是隐含每一个非静态成员函数内的一种指针</p> <p>this指针不需要定义，直接使用即可。</p> <p>this指针的用途：</p> <ul><li>当形参和成员变量同名时，可用this指针来区分</li> <li>在类的非静态成员函数中返回对象本身，可使用 return *this</li></ul> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Person</span> <span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token comment">// this指针指向被调用的成员函数所属的对象</span>
        <span class="token keyword">this</span><span class="token operator">-&gt;</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span> <span class="token comment">//解决名称冲突</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">PersonAddAge</span><span class="token punctuation">(</span>Person <span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token operator">-&gt;</span>age <span class="token operator">+=</span> p<span class="token punctuation">.</span>age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//链式编程思想</span>
    <span class="token comment">//cout与cin也是如此</span>
    <span class="token comment">//如果需要返回本体，那么需要使用引用来返回</span>
    <span class="token comment">//如果返回类型为Person（即值返回），则会按值拷贝构造一个新对象，最终原对象只加了一次</span>
    Person<span class="token operator">&amp;</span> <span class="token function">PersonAddAgeN</span><span class="token punctuation">(</span>Person <span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
        <span class="token keyword">this</span><span class="token operator">-&gt;</span>age <span class="token operator">+=</span> p<span class="token punctuation">.</span>age<span class="token punctuation">;</span>
        <span class="token comment">//this是一个指向p2的指针，*this则是p2这个对象本身（的地址）</span>
        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//1.解决名称冲突</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p1的年龄为：&quot;</span> <span class="token operator">&lt;&lt;</span> p1<span class="token punctuation">.</span>age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//2.返回对象本身用*this</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Person <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    p2<span class="token punctuation">.</span><span class="token function">PersonAddAge</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p2的年龄为：&quot;</span> <span class="token operator">&lt;&lt;</span> p2<span class="token punctuation">.</span>age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Person <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    p2<span class="token punctuation">.</span><span class="token function">PersonAddAgeN</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">PersonAddAgeN</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">PersonAddAgeN</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p2的年龄为：&quot;</span> <span class="token operator">&lt;&lt;</span> p2<span class="token punctuation">.</span>age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// test01();</span>
    <span class="token comment">// test02();</span>
    <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.3.3 空指针调用成员函数</strong></p> <p>C++空指针也可以调用成员函数，但是要注意有没有用到this指针</p> <p>如果用到this指针，需要加以判断保证代码健壮性</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">showClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;This is class Person&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">showAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment">//解决方式，提高代码健壮性</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;age = &quot;</span> <span class="token operator">&lt;&lt;</span> m_Age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> 
        <span class="token comment">//每个对象的属性都会默认加上this指针，如this-&gt;m_Age</span>
        <span class="token comment">//当this是空时，那么this-&gt;m_Age则会报错</span>
        <span class="token comment">//报错的原因是传入指针为空</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> m_Age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
    p<span class="token operator">-&gt;</span><span class="token function">showClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//正常调用</span>
    p<span class="token operator">-&gt;</span><span class="token function">showAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//调用错误：this是nullptr</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.3.4 const修饰成员函数</strong></p> <p><strong>常函数：</strong></p> <ul><li>成员函数后加 const 后，我们称这个函数为<strong>常函数</strong></li> <li>常函数内不可以修改成员属性</li> <li>成员属性声明时附加mutable关键字，在常函数中依然可以修改。</li></ul> <p><strong>常对象：</strong></p> <ul><li>声明对象前加const称该对象为常对象</li> <li>常对象只能调用常函数</li> <li>常对象不允许修改普通属性（mutable属性除外）</li></ul> <p>声明形式：<code>类名 cosnt 对象名 (实参表)</code>或<code>cosnt 类名 对象名(实参表)</code></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">const</span>  <span class="token keyword">class</span>  <span class="token class-name">object</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token keyword">const</span> <span class="token function">object</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>也可以定义const指针:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">const</span> <span class="token keyword">class</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">class</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token keyword">const</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">class</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><code>class</code>为类名，<code>object</code>为对象名，<code>params</code>为实参列表，<code>p</code>为指针名。两种方式定义出来的对象都是常对象。</p> <p><strong>示例：</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_A</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_B</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token comment">//this指针的本质 是指针常量 指针的指向是不可以修改的</span>
    <span class="token comment">//Person * const this;//原本this是这种形式</span>
    <span class="token comment">//在后面加入const后相当于const Person *const this; //使得this指向的值也不可被修改</span>
    <span class="token keyword">void</span> <span class="token function">showPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token comment">//m_A = 100; //相当于 this-&gt;m_A = 100;常函数不可以修改成员属性，去掉函数后的const成立</span>
        <span class="token comment">//this = NULL; //this指针不可以修改指向</span>
        <span class="token keyword">this</span><span class="token operator">-&gt;</span>m_B <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">int</span> m_A<span class="token punctuation">;</span>
    <span class="token keyword">mutable</span> <span class="token keyword">int</span> m_B<span class="token punctuation">;</span> <span class="token comment">//特殊变量，即使在常函数中，也可以修改这个值，加关键字mutable</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p<span class="token punctuation">;</span>
    p<span class="token punctuation">.</span><span class="token function">showPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>

<span class="token comment">//常对象</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> Person p2<span class="token punctuation">;</span> <span class="token comment">//在对象前加上一个const修饰即为常对象，常对象必须初始化</span>
    <span class="token comment">//p2.m_A = 100;  //常对象的普通属性不可以被修改</span>
    p2<span class="token punctuation">.</span>m_B <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">//常对象的mutable属性在任何有权限的区域都可以修改</span>

    <span class="token comment">//常对象，只能调用常函数</span>
    p2<span class="token punctuation">.</span><span class="token function">showPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//p2.func(); //常对象不可以调用普通成员函数，因为普通成员函数可以修改属性</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-4-友元"><a href="#_3-4-友元" class="header-anchor">#</a> 3.4 友元</h4> <p>生活中你家有客厅(public), 有你的卧室(private)</p> <p>客厅所有来的客人都可以进去，但是你的卧室是私有的，也就是说只有你能进去</p> <p>但是呢，你也可以允许你的好闺蜜好基友进去。</p> <p>在程序里，有些私有属性，也想让类外特殊的一些函数或者类进行访问, 就需要用到友元的技术。</p> <p><strong>友元的作用就是让一个函数或者类 访问另一个类中的私有成员</strong></p> <p>友元的关键字为 <strong><code>friend</code></strong></p> <p>友元三种实现方式</p> <ul><li>全局函数做友元</li> <li>类做友元</li> <li>成员函数做友元</li></ul> <p><strong>3.4.1 全局函数做友元</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Building</span> <span class="token punctuation">{</span>
    <span class="token comment">//表明goodGay全局函数是本类的友元，可以访问私有成员</span>
    <span class="token keyword">friend</span> <span class="token keyword">void</span> <span class="token function">goodGay</span><span class="token punctuation">(</span>Building <span class="token operator">*</span>building<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Building</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_SittingRoom</span><span class="token punctuation">(</span><span class="token string">&quot;客厅&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_BedRoom</span><span class="token punctuation">(</span><span class="token string">&quot;卧室&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    string m_SittingRoom<span class="token punctuation">;</span> <span class="token comment">//客厅</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    string m_BedRoom<span class="token punctuation">;</span> <span class="token comment">//卧室</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//全局函数</span>
<span class="token keyword">void</span> <span class="token function">goodGay</span><span class="token punctuation">(</span>Building <span class="token operator">*</span>building<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;好基友的全局函数正在访问：&quot;</span> <span class="token operator">&lt;&lt;</span> building<span class="token operator">-&gt;</span>m_SittingRoom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;好基友的全局函数正在访问：&quot;</span> <span class="token operator">&lt;&lt;</span> building<span class="token operator">-&gt;</span>m_BedRoom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span><span class="token comment">//友元可访问私有</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Building building<span class="token punctuation">;</span>
    <span class="token function">goodGay</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>building<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><hr> <p><strong>3.4.2 类作为友元</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Building</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Goodgay</span><span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Goodgay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//参观函数，访问building中的属性</span>

    Building <span class="token operator">*</span>building<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//类做友元</span>
<span class="token keyword">class</span> <span class="token class-name">Building</span> <span class="token punctuation">{</span>
    <span class="token comment">//告诉编译器，Goodgay是本类的友元，可以访问本类私有成员</span>
    <span class="token keyword">friend</span> <span class="token keyword">class</span> <span class="token class-name">Goodgay</span><span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Building</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    string m_SittingRoom<span class="token punctuation">;</span> <span class="token comment">//客厅</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    string m_BedRoom<span class="token punctuation">;</span> <span class="token comment">//卧室</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//类外写成员函数</span>
<span class="token class-name">Building</span><span class="token double-colon punctuation">::</span><span class="token function">Building</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_SittingRoom</span><span class="token punctuation">(</span><span class="token string">&quot;客厅&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_BedRoom</span><span class="token punctuation">(</span><span class="token string">&quot;卧室&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Goodgay</span><span class="token double-colon punctuation">::</span><span class="token function">Goodgay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">building</span><span class="token punctuation">(</span><span class="token keyword">new</span> Building<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token class-name">Goodgay</span><span class="token double-colon punctuation">::</span><span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;好基友类正在访问：&quot;</span> <span class="token operator">&lt;&lt;</span> building<span class="token operator">-&gt;</span>m_SittingRoom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;好基友类正在访问：&quot;</span> <span class="token operator">&lt;&lt;</span> building<span class="token operator">-&gt;</span>m_BedRoom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Goodgay g1<span class="token punctuation">;</span>
    g1<span class="token punctuation">.</span><span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.4.3 成员函数做友元</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Building</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Goodgay</span><span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Goodgay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//参观函数，访问building中的私有成员</span>
    <span class="token keyword">void</span> <span class="token function">visit2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//不能访问building中的私有成员</span>
    Building <span class="token operator">*</span>building<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//类做友元</span>
<span class="token keyword">class</span> <span class="token class-name">Building</span> <span class="token punctuation">{</span>
    <span class="token comment">//告诉编译器，Goodgay下的visit是本类的友元，可以访问私有成员</span>
    <span class="token keyword">friend</span> <span class="token keyword">void</span> <span class="token class-name">Goodgay</span><span class="token double-colon punctuation">::</span><span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Building</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    string m_SittingRoom<span class="token punctuation">;</span> <span class="token comment">//客厅</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    string m_BedRoom<span class="token punctuation">;</span> <span class="token comment">//卧室</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//类外写成员函数</span>
<span class="token class-name">Building</span><span class="token double-colon punctuation">::</span><span class="token function">Building</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_SittingRoom</span><span class="token punctuation">(</span><span class="token string">&quot;客厅&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_BedRoom</span><span class="token punctuation">(</span><span class="token string">&quot;卧室&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token class-name">Goodgay</span><span class="token double-colon punctuation">::</span><span class="token function">Goodgay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">building</span><span class="token punctuation">(</span><span class="token keyword">new</span> Building<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token class-name">Goodgay</span><span class="token double-colon punctuation">::</span><span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;visit正在访问：&quot;</span> <span class="token operator">&lt;&lt;</span> building<span class="token operator">-&gt;</span>m_SittingRoom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;visit正在访问：&quot;</span> <span class="token operator">&lt;&lt;</span> building<span class="token operator">-&gt;</span>m_BedRoom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">void</span> <span class="token class-name">Goodgay</span><span class="token double-colon punctuation">::</span><span class="token function">visit2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;visit2正在访问：&quot;</span> <span class="token operator">&lt;&lt;</span> building<span class="token operator">-&gt;</span>m_SittingRoom <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token comment">//cout &lt;&lt; &quot;visit2正在访问：&quot; &lt;&lt; building-&gt;m_BedRoom &lt;&lt; endl; //此时visit可以访问私有成员，visit2不可以</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Goodgay g1<span class="token punctuation">;</span>
    g1<span class="token punctuation">.</span><span class="token function">visit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    g1<span class="token punctuation">.</span><span class="token function">visit2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-5-运算符重载"><a href="#_3-5-运算符重载" class="header-anchor">#</a> 3.5 运算符重载</h4> <p>运算符重载概念：对已有的运算符重新定义，赋予其另一种功能，以适应不同的数据类型</p> <p><strong>3.5.1 加号运算符重载</strong></p> <p>作用：实现两个自定义数据类型相加的运算</p> <p>可以通过上面的链式编程思想来理解，（ps: 下方第一个返回值掉了&amp;, 应该为Person&amp;)</p> <p>&amp; PersonAddPerson 相当于 operate+</p> <p><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220224195951042.png" alt="image-20220224195951042"></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//1.成员函数重载+号</span>
    <span class="token comment">// Person operator+(Person &amp;p) {</span>
    <span class="token comment">//     Person temp;</span>
    <span class="token comment">//     temp.m_A = this-&gt;m_A + p.m_A;</span>
    <span class="token comment">//     temp.m_B = this-&gt;m_B + p.m_B;</span>
    <span class="token comment">//     return temp;</span>
    <span class="token comment">// }</span>

    <span class="token keyword">int</span> m_A<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_B<span class="token punctuation">;</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_A</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_B</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//2.全局函数重载+号</span>
Person <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>Person <span class="token operator">&amp;</span>p1<span class="token punctuation">,</span> Person <span class="token operator">&amp;</span>p2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person temp<span class="token punctuation">;</span>
    temp<span class="token punctuation">.</span>m_A <span class="token operator">=</span> p1<span class="token punctuation">.</span>m_A <span class="token operator">+</span> p2<span class="token punctuation">.</span>m_A<span class="token punctuation">;</span>
    temp<span class="token punctuation">.</span>m_B <span class="token operator">=</span> p1<span class="token punctuation">.</span>m_B <span class="token operator">+</span> p2<span class="token punctuation">.</span>m_B<span class="token punctuation">;</span>
    <span class="token keyword">return</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//运算符重载中的函数重载</span>
Person <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span>Person <span class="token operator">&amp;</span>p1<span class="token punctuation">,</span> <span class="token keyword">int</span> num<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person temp<span class="token punctuation">;</span>
    temp<span class="token punctuation">.</span>m_A <span class="token operator">=</span> p1<span class="token punctuation">.</span>m_A <span class="token operator">+</span> num<span class="token punctuation">;</span>
    temp<span class="token punctuation">.</span>m_B <span class="token operator">=</span> p1<span class="token punctuation">.</span>m_B <span class="token operator">+</span> num<span class="token punctuation">;</span>
    <span class="token keyword">return</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p1<span class="token punctuation">;</span>
    p1<span class="token punctuation">.</span>m_A <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    p1<span class="token punctuation">.</span>m_B <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    Person <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//1.成员函数重载本质调用</span>
    <span class="token comment">// Person p3 = p1.operator+(p2);</span>

    <span class="token comment">//2.全局函数重载本质调用</span>
    <span class="token comment">// Person p3 = operator+(p1, p2);</span>

    Person p3 <span class="token operator">=</span> p1 <span class="token operator">+</span> p2<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p3.m_A = &quot;</span> <span class="token operator">&lt;&lt;</span> p3<span class="token punctuation">.</span>m_A <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p3.m_B = &quot;</span> <span class="token operator">&lt;&lt;</span> p3<span class="token punctuation">.</span>m_B <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token comment">//运算符重载也可以发生函数重载</span>
    Person p4 <span class="token operator">=</span> p1 <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span> <span class="token comment">//Person + int</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p4.m_A = &quot;</span> <span class="token operator">&lt;&lt;</span> p4<span class="token punctuation">.</span>m_A <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p4.m_B = &quot;</span> <span class="token operator">&lt;&lt;</span> p4<span class="token punctuation">.</span>m_B <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>总结一：对于内置的数据类型的表达式，其运算符是不可能发生改变的</p> <p>总结二：不要滥用运算符重载（比如把加法写成减法）</p></blockquote> <p><strong>3.5.2 左移运算符重载</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">friend</span> ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span>cout<span class="token punctuation">,</span> Person <span class="token operator">&amp;</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token comment">//利用成员函数重载左移运算符 p.operator&lt;&lt;(cout) 简化版本 p &lt;&lt; cout</span>
    <span class="token comment">//不会利用成员函数重载&lt;&lt;运算符，因为无法实现 cout在左侧</span>
    <span class="token comment">//void operator&lt;&lt;() {}</span>
    <span class="token keyword">int</span> m_A<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_B<span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_A</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_B</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_A</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_B</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//只能利用全局函数重载左移运算符</span>
<span class="token comment">//如果传入参数非引用方式，那么就会创建一个新的对象，而cout对象全局只有一个，所以需要以引用的方式来进行传入</span>
<span class="token comment">//本质 operator&lt;&lt; (cout, p) 简化 cout &lt;&lt; p</span>
<span class="token comment">//若要访问私有，既可以通过在类内设置接口，也可以设置友元</span>
ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span>cout<span class="token punctuation">,</span> Person <span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p.m_A = &quot;</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>m_A <span class="token operator">&lt;&lt;</span> <span class="token string">&quot; p.m_B = &quot;</span> <span class="token operator">&lt;&lt;</span> p<span class="token punctuation">.</span>m_B<span class="token punctuation">;</span>
    <span class="token keyword">return</span> cout<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 引用是取别名，所以改为out也OK，他们本质都是指向同一块内存空间</span>
<span class="token comment">// ostream&amp; operator&lt;&lt;(ostream &amp;out, Person &amp;p) { </span>
<span class="token comment">//     out &lt;&lt; &quot;p.m_A = &quot; &lt;&lt; p.m_A &lt;&lt; &quot; p.m_B = &quot; &lt;&lt; p.m_B;</span>
<span class="token comment">//     return out;</span>
<span class="token comment">// }</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person p<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> p <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>总结：重载的左移运算符配合友元可以实现输出自定义的数据类型</p></blockquote> <p><strong>3.5.3 递增运算符重载</strong></p> <p>作用：通过重载递增运算符，实现自己的整型数据</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyInteger</span> <span class="token punctuation">{</span>
    <span class="token keyword">friend</span> ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> cout<span class="token punctuation">,</span> MyInteger myint<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">MyInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_Num</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token comment">//重载前置++ 返回引用是为了对同一个数据进行递增操作，而不是递增完返回对象后又拷贝构造一个新的对象</span>
    MyInteger<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_Num<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//重载后置++</span>
    <span class="token comment">//void operator++(int) int代表占位参数，可以用于区分前置和后置递增</span>
    MyInteger <span class="token keyword">operator</span><span class="token operator">++</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//后置递增返回的是局部对象，所以不加引用</span>
        <span class="token comment">//先 记录当时结果</span>
        MyInteger temp <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
        <span class="token comment">//后 递增</span>
        m_Num<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token comment">//最后将记录结果做返回</span>
        <span class="token keyword">return</span> temp<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_Num<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream<span class="token operator">&amp;</span> cout<span class="token punctuation">,</span> MyInteger myint<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> myint<span class="token punctuation">.</span>m_Num<span class="token punctuation">;</span>
    <span class="token keyword">return</span> cout<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    MyInteger myint<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token operator">++</span><span class="token punctuation">(</span><span class="token operator">++</span>myint<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> myint <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    MyInteger myint<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> myint<span class="token operator">++</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> myint <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// test01();</span>
    <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>总结：前置递增返回引用，后置递增返回值。</p></blockquote> <p>自己实现了一个--重载</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyInteger</span> <span class="token punctuation">{</span>
    <span class="token keyword">friend</span> ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span>cout<span class="token punctuation">,</span> MyInteger myint<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">MyInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">m_Num</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token comment">//前置++</span>
    MyInteger<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_Num<span class="token operator">--</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    MyInteger <span class="token keyword">operator</span><span class="token operator">--</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        MyInteger temp <span class="token operator">=</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">//先记录</span>
        <span class="token keyword">this</span><span class="token operator">-&gt;</span>m_Num<span class="token operator">--</span><span class="token punctuation">;</span> <span class="token comment">//再递减</span>
        <span class="token keyword">return</span> temp<span class="token punctuation">;</span> <span class="token comment">//再返回临时记录的结果</span>
    <span class="token punctuation">}</span>
    

<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_Num<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

ostream<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>ostream <span class="token operator">&amp;</span>cout<span class="token punctuation">,</span> MyInteger myint<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//此处myint为值传递会创建新对象</span>
    cout <span class="token operator">&lt;&lt;</span> myint<span class="token punctuation">.</span>m_Num<span class="token punctuation">;</span>
    <span class="token keyword">return</span> cout<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    MyInteger myint<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token operator">--</span><span class="token operator">--</span>myint <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> myint <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    MyInteger myint<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> myint<span class="token operator">--</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> myint <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.5.4 赋值运算符重载</strong></p> <p>C++编译器至少给一个类添加4个函数</p> <ol><li><p>默认构造函数（无参，函数体为空）</p></li> <li><p>默认析构函数（无参，函数体为空）</p></li> <li><p>默认拷贝构造函数，对属性进行值拷贝</p></li> <li><p>赋值运算符 operator=，对属性进行值拷贝</p></li></ol> <p>如果类中有属性指向堆区，做赋值操作时也会出现深浅拷贝问题，堆区内存重复释放。</p> <p><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220225100008881.png" alt="image-20220225100008881"></p> <p><strong>示例：</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_Age <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>m_Age <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">delete</span> m_Age<span class="token punctuation">;</span>
            m_Age <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//重载运算符=</span>
    Person<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>Person <span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//编译器提供浅拷贝</span>
        <span class="token comment">//m_Age = p.m_Age;</span>
        
        <span class="token comment">//应该先判断是否有属性在堆区，如果有释放干净，然后再深拷贝</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>m_Age <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">delete</span> m_Age<span class="token punctuation">;</span>
            m_Age <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//深拷贝</span>
        m_Age <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">.</span>m_Age<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//返回对象本身来支持连等</span>
        <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">int</span> <span class="token operator">*</span>m_Age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Person <span class="token function">p2</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Person <span class="token function">p3</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    p3 <span class="token operator">=</span> p2 <span class="token operator">=</span> p1<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p1的年龄为：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p1<span class="token punctuation">.</span>m_Age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p2的年龄为：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p2<span class="token punctuation">.</span>m_Age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p3的年龄为：&quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>p3<span class="token punctuation">.</span>m_Age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.5. 关系运算符<code>==</code>或<code>!=</code>重载</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Person</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">m_Name</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_Age</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">==</span><span class="token punctuation">(</span>Person <span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>m_Name <span class="token operator">==</span> p<span class="token punctuation">.</span>m_Name <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>m_Age <span class="token operator">==</span> p<span class="token punctuation">.</span>m_Age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">bool</span> <span class="token keyword">operator</span><span class="token operator">!=</span><span class="token punctuation">(</span>Person <span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>m_Name <span class="token operator">!=</span> p<span class="token punctuation">.</span>m_Name <span class="token operator">||</span> <span class="token keyword">this</span><span class="token operator">-&gt;</span>m_Age <span class="token operator">!=</span> p<span class="token punctuation">.</span>m_Age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    string m_Name<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_Age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person <span class="token function">p1</span><span class="token punctuation">(</span><span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Person <span class="token function">p2</span><span class="token punctuation">(</span><span class="token string">&quot;Jerry&quot;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p1 <span class="token operator">==</span> p2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p1 和 p2 是相等的！&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p1 和 p2 是不相等的！&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>p1 <span class="token operator">!=</span> p2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p1 和 p2 是不相等的！&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;p1 和 p2 是相等的！&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>4.5.6 函数调用运算符重载</strong></p> <ul><li>函数调用运算符() 也可以重载</li> <li>由于重载后的方式非常像函数的调用，因此称为仿函数</li> <li>仿函数没有固定写法，非常灵活</li></ul> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MyPrint</span> <span class="token punctuation">{</span>

<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//重载函数调用运算符</span>
    <span class="token keyword">void</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>string text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> text <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//仿函数没有固定写法，非常灵活</span>
<span class="token comment">//加法类</span>
<span class="token keyword">class</span> <span class="token class-name">MyAdd</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    MyPrint myprint<span class="token punctuation">;</span>
    <span class="token function">myprint</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//由于重载后的方式非常像函数的调用，因此称为仿函数</span>
    MyAdd myadd<span class="token punctuation">;</span>
    <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">myadd</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;ret = &quot;</span> <span class="token operator">&lt;&lt;</span> ret <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token function">myadd</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token comment">//匿名函数对象调用: 匿名对象创建完在本行执行结束立即释放，匿名对象调用重载的()</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;MyAdd()(100, 100) = &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token function">MyAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-6-继承"><a href="#_3-6-继承" class="header-anchor">#</a> 3.6 继承</h4> <p><strong>继承是面向对象三大特性之一</strong></p> <p>有些类与类之间存在特殊的关系，例如下图中：</p> <p><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220225110230867.png" alt="image-20220225110230867"></p> <p>定义这些类时，下级别的成员除了拥有上一级的共性，还有自己的特性。</p> <p>这个时候，我们就可以考虑利用继承的技术，减少重复代码。</p> <p><strong>3.6.1 继承基本语法</strong></p> <p>例如很多网站中，都有公共头部，公共的底部，甚至公共的左侧列表，只有中心内容不同</p> <p>接下来我们分别利用普通写法和继承写法来实现网页中的内容，看一下继承存在的意义及好处</p> <p><strong>普通实现：</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//普通实现页面</span>
<span class="token comment">//Java页面</span>
<span class="token keyword">class</span> <span class="token class-name">Java</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;首页、公开课、登录、注册...（公共头部）&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;帮助中心、交流合作、站内地图...（公共底部）&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">left</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Java、Python、C++、...（公共类列表）&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Java学科视频&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//Python页面</span>
<span class="token keyword">class</span> <span class="token class-name">Python</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;首页、公开课、登录、注册...（公共头部）&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;帮助中心、交流合作、站内地图...（公共底部）&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">left</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Java、Python、C++、...（公共类列表）&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Python学科视频&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//C++页面</span>
<span class="token keyword">class</span> <span class="token class-name">CPP</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;首页、公开课、登录、注册...（公共头部）&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;帮助中心、交流合作、站内地图...（公共底部）&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">left</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Java、Python、C++、...（公共类列表）&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Python学科视频&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Java页面&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    Java ja<span class="token punctuation">;</span>
    ja<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ja<span class="token punctuation">.</span><span class="token function">footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ja<span class="token punctuation">.</span><span class="token function">left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ja<span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;-------------------&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Python页面&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    Python py<span class="token punctuation">;</span>
    py<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    py<span class="token punctuation">.</span><span class="token function">footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    py<span class="token punctuation">.</span><span class="token function">left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    py<span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>继承实现（继承公共部分）：</strong></p> <p>语法：<code>class 子类 : 继承方式 父类 {};</code></p> <p><code>class A : public B {}</code>;</p> <p>子类 也称为 派生类</p> <p>父类 也称为 基类</p> <p>好处：减少重复的代码</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//继承实现页面</span>
<span class="token comment">//公共部分</span>
<span class="token keyword">class</span> <span class="token class-name">BasePage</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;首页、公开课、登录、注册...（公共头部）&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;帮助中心、交流合作、站内地图...（公共底部）&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">left</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Java、Python、C++、...（公共类列表）&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//实现继承</span>

<span class="token comment">//Java页面</span>
<span class="token keyword">class</span> <span class="token class-name">Java</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">BasePage</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Java学科视频&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//Python页面</span>
<span class="token keyword">class</span> <span class="token class-name">Python</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">BasePage</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Python学科视频&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//C++页面</span>
<span class="token keyword">class</span> <span class="token class-name">CPP</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">BasePage</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;C++学科视频&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Java页面&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    Java ja<span class="token punctuation">;</span>
    ja<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ja<span class="token punctuation">.</span><span class="token function">footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ja<span class="token punctuation">.</span><span class="token function">left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ja<span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;-------------------&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Python页面&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    Python py<span class="token punctuation">;</span>
    py<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    py<span class="token punctuation">.</span><span class="token function">footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    py<span class="token punctuation">.</span><span class="token function">left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    py<span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;-------------------&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;C++页面&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    CPP cpp<span class="token punctuation">;</span>
    cpp<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cpp<span class="token punctuation">.</span><span class="token function">footer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cpp<span class="token punctuation">.</span><span class="token function">left</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cpp<span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>派生类中的成员，包含两大类</p> <p>一类是从基类中继承来的，一类是自己增加的成员</p> <p>从基类继承过来的表现其共性，而新增的成员体现了其个性</p></blockquote> <p><strong>3.6.2 继承方式</strong></p> <p>继承语法： <code>class 子类 : 继承方式 父类 {};</code></p> <p><strong>继承方式一共三种：</strong></p> <ul><li>公共继承</li> <li>保护继承</li> <li>私有继承</li></ul> <p><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220225142750806.png" alt="image-20220225142750806"></p> <p>公共继承：父类中的public, protected成员被子类继承且访问权限不变，父类的private子类不可访问</p> <p>保护继承：父类的public,protected成员被子类继承，且访问权限修改为protected，父类private子类不可访问</p> <p>私有继承：public,protected被继承且权限修改为private，父类的private子类不可访问</p> <p><strong>3.6.3 继承中的对象模型</strong></p> <p>**问题：**子类中继承过来的成员，哪些属于子类对象中？</p> <p><strong>示例：</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_A<span class="token punctuation">;</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_B<span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_C<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span><span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_D<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//vs的开发工具</span>
<span class="token comment">//利用开发人员命令提示工具查看对象模型</span>
<span class="token comment">//跳转盘符 F:</span>
<span class="token comment">//跳转文件路径 cd 具体路径下</span>
<span class="token comment">//查看命令</span>
<span class="token comment">//cl /d1 reportSingleClassLayout类名 文件名</span>
<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//父类中所有非静态成员属性都会被子类继承下去</span>
    <span class="token comment">//父类的私有成员属性被编译器隐藏了，因此访问不到，但确实继承下去了</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;size of Son = &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Son<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>父类中所有非静态成员属性都会被子类继承下去,父类的私有成员属性被编译器隐藏了，因此访问不到，但确实继承下去了</p></blockquote> <p><strong>3.6.4 继承中构造和析构顺序</strong></p> <p>子类继承父类后，<strong>当创建子类对象，也会调用父类的构造函数</strong></p> <p>**问题：**父类和子类的构造和析构顺序谁先谁后？</p> <p>**答：**构造：Base -&gt; Son(先父再子)</p> <p>析构：Son -&gt; Base(先子再父)</p> <p><strong>示例：</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base构造函数！&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base析构函数！&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Son构造函数！&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">~</span><span class="token function">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Son析构函数！&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Son s1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.6.5 继承中同名成员处理方式</strong></p> <p>问题：当子类与父类出现同名的成员，如何通过子类对象，访问到子类或父类中同名的数据呢？</p> <ul><li>访问子类同名成员 直接访问即可</li> <li>访问父类同名成员 需要加作用域 ::</li></ul> <p>注意：同名成员函数即使发生重载，也需要加::来调用</p> <p>如果子类中出现同名成员函数，那么子类会隐藏掉父类中的所有同名成员，包括重载</p> <p><strong>示例：</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_A <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base-func()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base-func(int)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> m_A<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_A <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Son-func()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> m_A<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Son s1<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Son下的m_A: &quot;</span> <span class="token operator">&lt;&lt;</span> s1<span class="token punctuation">.</span>m_A <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base下的m_A: &quot;</span> <span class="token operator">&lt;&lt;</span> s1<span class="token punctuation">.</span>Base<span class="token double-colon punctuation">::</span>m_A <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//同名即使重载也需要</span>
<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Son s1<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Son的func：&quot;</span><span class="token punctuation">;</span>
    s1<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base的func：&quot;</span><span class="token punctuation">;</span>
    s1<span class="token punctuation">.</span><span class="token class-name">Base</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//如果子类中出现同名成员函数，那么子类会隐藏掉父类中的所有同名成员，包括重载</span>
    <span class="token comment">//需要加作用域来访问父类中的同名成员</span>
    <span class="token comment">//s1.func(100);</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base的func(int)：&quot;</span><span class="token punctuation">;</span>
    s1<span class="token punctuation">.</span><span class="token class-name">Base</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.6.6 继承中同名静态成员处理方式</strong></p> <p>问题：继承中同名的静态成员在子类对象上如何进行访问？</p> <p>静态成员和非静态成员出现同名，处理方式一致，且同一个类中的对象共享同一份静态成员</p> <ul><li>访问子类同名成员 直接访问即可</li> <li>访问父类同名成员 需要加作用域</li></ul> <p><strong>示例：</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> m_A<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base - static void func&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base - static void func(int)&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> Base<span class="token double-colon punctuation">::</span>m_A <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> m_A<span class="token punctuation">;</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Son - static void func&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> Son<span class="token double-colon punctuation">::</span>m_A <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Son s<span class="token punctuation">;</span>
    <span class="token comment">//1.通过对象访问</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Son的m_A: &quot;</span> <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>m_A <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base的m_A: &quot;</span> <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>Base<span class="token double-colon punctuation">::</span>m_A <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token comment">//2.通过类名访问</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;通过类名访问：&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Son   下 m_A = &quot;</span> <span class="token operator">&lt;&lt;</span> Son<span class="token double-colon punctuation">::</span>m_A <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base  下 m_A = &quot;</span> <span class="token operator">&lt;&lt;</span> Base<span class="token double-colon punctuation">::</span>m_A <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//直接通过父类访问静态成员</span>
    <span class="token comment">//第一个::代表通过类名方式访问 第二个::代表访问父类作用域下</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base  下 m_A = &quot;</span> <span class="token operator">&lt;&lt;</span> Son<span class="token double-colon punctuation">::</span>Base<span class="token double-colon punctuation">::</span>m_A <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">//通过子类访问父类，再访问静态成员</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token comment">//1.通过对象访问</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;通过对象访问: &quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    Son s<span class="token punctuation">;</span>
    s<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    s<span class="token punctuation">.</span><span class="token class-name">Base</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//2.通过类名方式访问</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;通过类名访问: &quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token class-name">Son</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Son<span class="token double-colon punctuation">::</span><span class="token class-name">Base</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Son::func(100);</span>
    <span class="token comment">//如果子类中出现同名静态成员函数，那么子类会隐藏掉父类中的所有同名成员，包括重载</span>
    <span class="token comment">//需要加作用域来访问父类中的同名成员</span>
    Son<span class="token double-colon punctuation">::</span><span class="token class-name">Base</span><span class="token double-colon punctuation">::</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// test01();</span>
    <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.6.7 多继承语法</strong></p> <p>语法：<code>class 子类 : 继承方式1 父类1, 继承方式2 父类2... {}</code></p> <p>多继承可能会引发父类中有同名成员出现，需要加作用域区分</p> <p><strong>C++实际开发中不建议用多继承</strong></p> <p><strong>示例：</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Base1</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Base1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_A <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> m_A<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Base2</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Base2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_A <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> m_A<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base1</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">Base2</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_C <span class="token operator">=</span> <span class="token number">300</span><span class="token punctuation">;</span>
        m_D <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> m_C<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_D<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Son s<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token comment">//当父类中出现同名成员，子类使用需要加作用域, 否则会报错“不明确”</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Base2::m_A = &quot;</span> <span class="token operator">&lt;&lt;</span> s<span class="token punctuation">.</span>Base2<span class="token double-colon punctuation">::</span>m_A <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>当父类中出现同名成员，子类使用需要加作用域</p></blockquote> <p><strong>4.6.8 菱形继承</strong></p> <p><strong>菱形继承概念</strong></p> <p>​		两个派生类继承同一个基类</p> <p>​		又有某个类同时继承这两个派生类</p> <p>​		这种继承被称为菱形继承，或者钻石继承</p> <img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220225182333022.png" alt="image-20220225182333022" style="zoom:50%;"> <p><strong>典型的菱形继承案例：</strong></p> <img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220225182443947.png" alt="image-20220225182443947" style="zoom:60%;"> <p><strong>菱形继承问题：</strong></p> <div class="language- extra-class"><pre><code>1. 羊继承了动物的数据，驼同样继承了动物的数据，当草泥马使用数据时，就会产生二义性。
2. 草泥马继承自动物的数据继承了两份，其实我们应该清楚，这份数据我们只需要一份即可。
</code></pre></div><p>通过virtual关键字来进行继承</p> <p>语法：<code>class son : virtual public Base {};</code></p> <p><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220225185639735.png" alt="image-20220225185639735"></p> <p><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220225185839330.png" alt="image-20220225185839330"></p> <p>virtual底层是继承了两个指针vbptr（虚基类指针） 指向 vbtable（虚继承表）</p> <p>vbptr通过偏移量，找到虚基类</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//动物类</span>
<span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_Age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//利用虚继承可解决菱形继承问题</span>
<span class="token comment">//继承之前 加上关键字 virtual 变为虚继承</span>
<span class="token comment">//Animal类称为 虚基类</span>
<span class="token comment">//羊类</span>
<span class="token keyword">class</span> <span class="token class-name">Sheep</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">virtual</span> <span class="token keyword">public</span> <span class="token class-name">Animal</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//驼类</span>
<span class="token keyword">class</span> <span class="token class-name">Tuo</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">virtual</span> <span class="token keyword">public</span> <span class="token class-name">Animal</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//草泥马</span>
<span class="token keyword">class</span> <span class="token class-name">SheepTuo</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Sheep</span><span class="token punctuation">,</span> <span class="token keyword">public</span> <span class="token class-name">Tuo</span></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    SheepTuo st<span class="token punctuation">;</span>
    <span class="token comment">//当出现菱形继承的时候，两个父类拥有相同数据，需要加以作用域区分</span>
    st<span class="token punctuation">.</span>Sheep<span class="token double-colon punctuation">::</span>m_Age <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
    st<span class="token punctuation">.</span>Tuo<span class="token double-colon punctuation">::</span>m_Age <span class="token operator">=</span> <span class="token number">28</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;st.Sheep::m_Age = &quot;</span> <span class="token operator">&lt;&lt;</span> st<span class="token punctuation">.</span>Sheep<span class="token double-colon punctuation">::</span>m_Age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;st.Tuo::m_Age = &quot;</span> <span class="token operator">&lt;&lt;</span> st<span class="token punctuation">.</span>Tuo<span class="token double-colon punctuation">::</span>m_Age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    <span class="token comment">//这份数据我们知道, 只有一份就够了,菱形继承导致数据有两份，资源浪费</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;st.m_Age = &quot;</span> <span class="token operator">&lt;&lt;</span> st<span class="token punctuation">.</span>m_Age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>总结：</p> <p>菱形继承带来的主要问题是子类继承两份相同数据，导致资源浪费以及毫无意义</p> <p>利用虚继承可以解决菱形继承问题</p> <p>虚继承本质是通过继承来的虚基类指针，来让基类指针指向子类中继承来的基类的对象。</p></blockquote> <h4 id="_3-7-多态"><a href="#_3-7-多态" class="header-anchor">#</a> 3.7 多态</h4> <p><strong>3.7.1 多态的基本概念</strong></p> <p><strong>多态是C++面向对象的三大特性之一（封装、继承、多态）</strong></p> <p>多态分为两类</p> <ul><li>静态多态：函数重载 和 运算符重载属于静态多态，复用函数名</li> <li>动态多态：派生类 和 虚函数实现运行时多态</li></ul> <p>静态多态和动态多态区别：</p> <ul><li>静态多态的函数地址早绑定 - 编译阶段确定函数地址</li> <li>动态多态的函数地址晚绑定 - 运行阶段确定函数地址</li></ul> <p>下面案例：</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//动物类</span>
<span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//加上virtual实现地址晚绑定</span>
    <span class="token comment">//虚函数</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;动物在说话&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//猫类</span>
<span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Animal</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;小猫在说话&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//狗类</span>
<span class="token keyword">class</span> <span class="token class-name">Dog</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Animal</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;小狗在说话&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">//执行说话函数</span>
<span class="token comment">//地址早绑定 在编译阶段就确定了函数地址</span>
<span class="token comment">//如果想执行让猫说话，那么这个函数地址就不能提前绑定，需要在运行阶段进行绑定，地址晚绑定</span>

<span class="token comment">//动态多态满足条件</span>
<span class="token comment">// 1. 有继承关系</span>
<span class="token comment">// 2. 子类重写父类的虚函数（重写：返回值类型，函数名，参数列表完全相同）</span>
<span class="token comment">// 子类写不写virtual都无影响</span>

<span class="token comment">//动态多态的使用</span>
<span class="token comment">// 父亲的指针或者引用 指向子类对象</span>

<span class="token comment">//个人总结</span>
<span class="token comment">//当传入对象类型定义为父类，调用函数时传入的是子类时，地址早绑定，里边会执行父类的地址</span>
<span class="token comment">//父类与子类有同名函数，若父类的同名函数设置为虚函数，那么就会地址晚绑定，此时才会执行传入的类成员函数</span>


<span class="token keyword">void</span> <span class="token function">doSpeak</span><span class="token punctuation">(</span>Animal <span class="token operator">&amp;</span>animal<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//Animal &amp;animal = cat;</span>
    animal<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>



<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Cat cat<span class="token punctuation">;</span>
    cat<span class="token punctuation">.</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">doSpeak</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span><span class="token punctuation">;</span> 
    Dog dog<span class="token punctuation">;</span>
    <span class="token function">doSpeak</span><span class="token punctuation">(</span>dog<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;sizeof Animal = &quot;</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span> <span class="token punctuation">(</span>Animal<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token comment">//64位系统中，指针大小为8字节2^64</span>
    <span class="token comment">//32位系统中，指针大小为4字节2^32</span>
    <span class="token comment">//说明此时Animal中有一个指针</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>总结：</p> <p>多态满足条件：</p> <ul><li>有继承关系</li> <li>子类重写父类中的虚函数</li></ul> <p>多态使用条件</p> <ul><li>父类指针或引用指向子类对象</li></ul> <p>重写：函数返回值类型 函数名 参数列表 完全一致重写</p> <p><strong>多态原理剖析</strong></p> <p><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220226104034541.png" alt="image-20220226104034541"></p> <p>如果子类不重写，那么子类中的虚函数表 内部 存放地址仍然是继承于父类，即与父类一致，仍为&amp;Animal::speak</p> <p>重写之后，由子类中的函数地址覆盖为&amp;Cat::speak()</p> <p><strong>3.7.2 多态实现计算器案例</strong></p> <p>在真的开发中 提倡 开闭原则</p> <p>**开闭原则：**对扩展进行开放，对修改进行关闭</p> <p>多态好处：</p> <p>1.组织结构清晰</p> <p>2.可读性强</p> <p>3.对于前期和后期的扩展以及维护性高</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>


<span class="token comment">//有的设计如果想扩展新的功能，需要修改源码</span>

<span class="token comment">//在真的开发中 提倡 开闭原则</span>
<span class="token comment">//开闭原则：对扩展进行开放，对修改进行关闭</span>


<span class="token comment">//利用多态实现计算器</span>
<span class="token comment">//多态好处：</span>
<span class="token comment">//1.组织结构清晰</span>
<span class="token comment">//2.可读性强</span>
<span class="token comment">//3.对于前期和后期的扩展以及维护性高</span>

<span class="token comment">//实现计算器</span>
<span class="token keyword">class</span> <span class="token class-name">AbstractCalculator</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">int</span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> m_Num1<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_Num2<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AddCalculator</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractCalculator</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> m_Num1 <span class="token operator">+</span> m_Num2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">SubCalculator</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractCalculator</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> m_Num1 <span class="token operator">-</span> m_Num2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">MultiCalculator</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractCalculator</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> <span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> m_Num1 <span class="token operator">*</span> m_Num2<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//多态使用条件，父类的引用或指针指向子类对象</span>
    AbstractCalculator <span class="token operator">*</span>abc <span class="token operator">=</span> <span class="token keyword">new</span> AddCalculator<span class="token punctuation">;</span>
    abc<span class="token operator">-&gt;</span>m_Num1 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    abc<span class="token operator">-&gt;</span>m_Num2 <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> abc<span class="token operator">-&gt;</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> abc<span class="token punctuation">;</span>

    abc <span class="token operator">=</span> <span class="token keyword">new</span> SubCalculator<span class="token punctuation">;</span>
    abc<span class="token operator">-&gt;</span>m_Num1 <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    abc<span class="token operator">-&gt;</span>m_Num2 <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> abc<span class="token operator">-&gt;</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> abc<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.7.3 纯虚函数和抽象类</strong></p> <p>在多态中，通常父类中虚函数的实现是毫无意义的，主要都是调用子类重写的内容</p> <p>因此可以将虚函数改为<strong>纯虚函数</strong></p> <p>纯虚函数语法：<code>virtual 返回值类型 函数名 (参数列表) = 0</code></p> <p>当类中有了纯虚函数，这个类也称为抽象类</p> <p><strong>抽象类的特点：</strong></p> <ul><li>无法实例化对象</li> <li>子类必须重写抽象类中的纯虚函数，否则也属于抽象类</li></ul> <p><strong>示例：</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//纯虚函数</span>
    <span class="token comment">//类中只要有一个纯虚函数，那么该类即为抽象类</span>
    <span class="token comment">//抽象类特点：</span>
    <span class="token comment">//1.无法实例化对象</span>
    <span class="token comment">//2.抽象类的子类，必须重写父类的纯虚函数，否则其本身也为抽象类</span>

    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;func函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//virtual和;可加可不加</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Base b;   //抽象类无法实例化对象</span>
    <span class="token comment">// new Base; //抽象类无法实例化对象</span>
    Base <span class="token operator">*</span>base <span class="token operator">=</span> <span class="token keyword">new</span> Son<span class="token punctuation">;</span>
    base<span class="token operator">-&gt;</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.7.4 多态案例二-制作饮品</strong></p> <p><strong>案例描述：</strong></p> <p>制作饮品的大致流程为：煮水 - 冲泡 - 倒入杯中 - 加入辅料</p> <p>利用多态技术实现本案例，提供抽象制作饮品基类，提供子类制作咖啡和茶叶</p> <img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220226165415842.png" alt="image-20220226165415842" style="zoom:80%;"> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//多态案例2 制作饮品</span>
<span class="token keyword">class</span> <span class="token class-name">AbstractDrinking</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//煮水</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Boil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//冲泡</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">Brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//倒入杯中</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">PourInCup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//加入辅料</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">PutSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">//制作饮品</span>
    <span class="token keyword">void</span> <span class="token function">makeDrink</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">Boil</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">Brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">PourInCup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">PutSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//制作咖啡</span>
<span class="token keyword">class</span> <span class="token class-name">Coffee</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractDrinking</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//煮水</span>
    <span class="token keyword">void</span> <span class="token function">Boil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;煮农夫山泉&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//冲泡</span>
    <span class="token keyword">void</span> <span class="token function">Brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;冲泡咖啡&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//倒入杯中</span>
    <span class="token keyword">void</span> <span class="token function">PourInCup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;倒入杯中&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//加入辅料</span>
    <span class="token keyword">void</span> <span class="token function">PutSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;加入糖和牛奶&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">//制作咖啡</span>
<span class="token keyword">class</span> <span class="token class-name">Tea</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">AbstractDrinking</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//煮水</span>
    <span class="token keyword">void</span> <span class="token function">Boil</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;煮矿泉水&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//冲泡</span>
    <span class="token keyword">void</span> <span class="token function">Brew</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;冲泡茶叶&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//倒入杯中</span>
    <span class="token keyword">void</span> <span class="token function">PourInCup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;倒入杯中&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//加入辅料</span>
    <span class="token keyword">void</span> <span class="token function">PutSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;加入柠檬&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">doWork</span><span class="token punctuation">(</span>AbstractDrinking <span class="token operator">*</span>abs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    abs<span class="token operator">-&gt;</span><span class="token function">makeDrink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> abs<span class="token punctuation">;</span> <span class="token comment">//使用后释放</span>
<span class="token punctuation">}</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//制作咖啡</span>
    <span class="token function">doWork</span><span class="token punctuation">(</span><span class="token keyword">new</span> Coffee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;---------------&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">doWork</span><span class="token punctuation">(</span><span class="token keyword">new</span> Tea<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3.7.5 虚析构和纯虚析构</strong></p> <p>多态使用时，如果子类中有属性开辟到堆区，那么父类指针在释放时无法调用到子类的析构代码</p> <p>解决方式：将父类中的析构函数改为<strong>虚析构</strong>和<strong>纯虚析构</strong></p> <p>虚析构和纯虚析构共性：</p> <ul><li>可以解决父类指针释放子类对象</li> <li>都需要具体的函数实现</li></ul> <p>虚析构和纯虚析构区别：</p> <ul><li>如果是纯虚析构，该类属于抽象类，无法实例化对象</li></ul> <p>虚析构语法</p> <p><code>virtual ~类名(){}</code></p> <p>纯虚析构语法：</p> <p><code>virtual ~类名() = 0;</code></p> <p><code>类名::~类名(){}</code></p> <p>注意：纯虚析构需要使用上述方法在类外实现</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Animal构造函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// virtual ~Animal() {</span>
    <span class="token comment">//     cout &lt;&lt; &quot;Animal析构函数调用&quot; &lt;&lt; endl;</span>
    <span class="token comment">// }</span>

    <span class="token comment">//纯虚析构</span>
    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token comment">//若不实现该纯虚析构，会发生“1个无法解析的外部命令”，链接时发生的错误</span>
    <span class="token comment">//在类外实现</span>

    <span class="token comment">//纯虚函数，子类实现</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">Animal</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Animal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Animal纯虚析构函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Cat</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Animal</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Cat</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_Name <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">string</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Cat的构造函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token operator">*</span>m_Name <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;小猫在说话&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token operator">~</span><span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>m_Name <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Cat的析构函数调用&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
            <span class="token keyword">delete</span> m_Name<span class="token punctuation">;</span>
            m_Name <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    string <span class="token operator">*</span>m_Name<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Animal <span class="token operator">*</span>animal <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token string">&quot;Tom&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    animal<span class="token operator">-&gt;</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//父类的指针在析构时，不会调用子类析构函数，导致子类如果有堆区属性，出现内存泄露</span>
    <span class="token comment">//解决方法，将父类的析构函数改为虚析构函数</span>
    <span class="token keyword">delete</span> animal<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>总结：</p> <ol><li>虚析构和纯虚析构都是用来解决通过父类指针释放子类对象</li> <li>如果子类中没有堆区数据，可以不写为虚析构或者纯虚析构</li> <li>拥有纯虚析构的类也是抽象类</li></ol> <p>**3.7.6 多态案例三 - 电脑组装 **</p> <p><strong>案例描述：</strong></p> <p>电脑主要组成部件为CPU（用于计算），显卡（用于显示），内存条（用于存储）</p> <p>将每个零件封装出抽象基类，并且提供不同的厂商生产不同的零件，例如Intel厂商和Lenovo厂商</p> <p>创建电脑类提供让电脑工作的函数，并且调用每个零件工作的接口</p> <p>测试时组装三台不同的电脑进行工作</p> <img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220227190633126.png" alt="image-20220227190633126" style="zoom:80%;"> <p><strong>示例：</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">//抽象出每个零件的类</span>
<span class="token comment">//抽象CPU</span>
<span class="token keyword">class</span> <span class="token class-name">CPU</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//抽象显卡</span>
<span class="token keyword">class</span> <span class="token class-name">VideoCard</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//抽象内存条</span>
<span class="token keyword">class</span> <span class="token class-name">Memory</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//组装电脑</span>
<span class="token keyword">class</span> <span class="token class-name">Computer</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Computer</span><span class="token punctuation">(</span>CPU <span class="token operator">*</span>cpu<span class="token punctuation">,</span> VideoCard <span class="token operator">*</span>vc<span class="token punctuation">,</span> Memory <span class="token operator">*</span>mem<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_cpu <span class="token operator">=</span> cpu<span class="token punctuation">;</span>
        m_vc <span class="token operator">=</span> vc<span class="token punctuation">;</span>
        m_mem <span class="token operator">=</span> mem<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//工作函数</span>
    <span class="token keyword">void</span> <span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_cpu<span class="token operator">-&gt;</span><span class="token function">calculate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m_mem<span class="token operator">-&gt;</span><span class="token function">storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        m_vc<span class="token operator">-&gt;</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//提供析构函数释放三个电脑的零件</span>
    <span class="token operator">~</span><span class="token function">Computer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>m_cpu <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">delete</span> m_cpu<span class="token punctuation">;</span>
            m_cpu <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>m_mem <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">delete</span> m_mem<span class="token punctuation">;</span>
            m_mem <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>m_vc <span class="token operator">!=</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">delete</span> m_vc<span class="token punctuation">;</span>
            m_vc <span class="token operator">=</span> <span class="token constant">NULL</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token keyword">private</span><span class="token operator">:</span>
    CPU <span class="token operator">*</span>m_cpu<span class="token punctuation">;</span> <span class="token comment">//cpu零件指针</span>
    VideoCard <span class="token operator">*</span>m_vc<span class="token punctuation">;</span> <span class="token comment">//显卡零件指针</span>
    Memory <span class="token operator">*</span>m_mem<span class="token punctuation">;</span> <span class="token comment">//内存条零件指针</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//具体厂商</span>
<span class="token comment">//Intel</span>
<span class="token keyword">class</span> <span class="token class-name">IntelCPU</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">CPU</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Intel的CPU开始计算了&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">IntelVideoCard</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">VideoCard</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Intel的显卡开始显示了&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">IntelMemory</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Memory</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Intel的内存条开始存储了&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">//Lenovo厂商</span>
<span class="token keyword">class</span> <span class="token class-name">LenovoCPU</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">CPU</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">calculate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Lenovo的CPU开始计算了&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">LenovoVideoCard</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">VideoCard</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Lenovo的显卡开始显示了&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">LenovoMemory</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Memory</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">storage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Lenovo的内存条开始存储了&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//第一台电脑零件</span>
    CPU <span class="token operator">*</span>intelCPU <span class="token operator">=</span> <span class="token keyword">new</span> IntelCPU<span class="token punctuation">;</span>
    VideoCard <span class="token operator">*</span>intelVC <span class="token operator">=</span> <span class="token keyword">new</span> IntelVideoCard<span class="token punctuation">;</span>
    Memory <span class="token operator">*</span>intelMemory <span class="token operator">=</span> <span class="token keyword">new</span> IntelMemory<span class="token punctuation">;</span>

    <span class="token comment">//创建第一台电脑</span>
    Computer <span class="token operator">*</span>computer1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Computer</span><span class="token punctuation">(</span>intelCPU<span class="token punctuation">,</span> intelVC<span class="token punctuation">,</span> intelMemory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    computer1<span class="token operator">-&gt;</span><span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> computer1<span class="token punctuation">;</span> <span class="token comment">//堆区零件需要释放，所以加上析构函数</span>

    <span class="token comment">//Lenovo厂商</span>
    Computer <span class="token operator">*</span>computer2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Computer</span><span class="token punctuation">(</span><span class="token keyword">new</span> LenovoCPU<span class="token punctuation">,</span> <span class="token keyword">new</span> LenovoVideoCard<span class="token punctuation">,</span> <span class="token keyword">new</span> LenovoMemory<span class="token punctuation">)</span><span class="token punctuation">;</span>
    computer2<span class="token operator">-&gt;</span><span class="token function">work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">delete</span> computer2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-函数提高"><a href="#_4-函数提高" class="header-anchor">#</a> 4 函数提高</h3> <h4 id="_4-1-函数默认参数"><a href="#_4-1-函数默认参数" class="header-anchor">#</a> 4.1 函数默认参数</h4> <p>在C++语法中，函数的形参列表中的形参是可以有默认值的。</p> <p>语法：<code>返回值类型 函数名 (参数 = 默认值) {}</code></p> <p><strong>示例：</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b <span class="token operator">+</span> c<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//1. 如果某个位置参数有默认值，那么这个位置往后，从左往右，必须都要有默认值</span>
<span class="token comment">//2. 如果函数声明有默认值，函数实现的时候就不能有默认参数</span>
<span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> a <span class="token operator">+</span> b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_4-2-函数的占位参数"><a href="#_4-2-函数的占位参数" class="header-anchor">#</a> 4.2 函数的占位参数</h4> <p>C++中函数的形参列表里可以有占位参数，用来做占位，调用函数时必须填补该位置</p> <p><strong>语法：</strong><code>返回值类型 函数名 (数据类型) {}</code></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">//函数占位时，占位参数也可以有默认参数</span>
<span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;this is a func&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">func</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//占位必须补参</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//占位参数也可以有默认参数</span>
<span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;this is a func&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">func</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//有默认参数则可不用补参</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_4-3-函数重载"><a href="#_4-3-函数重载" class="header-anchor">#</a> 4.3 函数重载</h4> <p>**作用：**函数名可以相同，提高复用性</p> <p><strong>函数重载满足条件：</strong></p> <ul><li><p>同一个作用域下</p></li> <li><p>函数名相同</p></li> <li><p>函数参数<strong>类型不同</strong> 或 <strong>个数不同</strong> 或 <strong>顺序不同</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">,</span> <span class="token keyword">int</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">float</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">float</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <p>**注意：**函数返回值不可以作为函数重载条件</p> <p><strong>注意事项：</strong></p> <ul><li><p>引用作为函数重载条件：引用作为重载条件 ，加const和不加const也能作为重载条件（注意，是引用时才能用const来区分）</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>
    cout<span class="token operator">&lt;&lt;</span><span class="token string">&quot;1&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 
<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>a<span class="token punctuation">)</span><span class="token punctuation">{</span>
    cout<span class="token operator">&lt;&lt;</span><span class="token string">&quot;2&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    <span class="token function">fun</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token punctuation">;</span>
    <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//const int &amp;a=10;</span>
    <span class="token comment">//相当于临时建一个变量t=10,让&amp;a=t; </span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 输出 1 和 2</span>
</code></pre></div><blockquote><p>PS: 这种情况不能使用</p></blockquote></li> <li><p>函数重载碰到函数默认参数</p> <p>正确情况</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout<span class="token operator">&lt;&lt;</span><span class="token string">&quot;1&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 
<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout<span class="token operator">&lt;&lt;</span><span class="token string">&quot;2&quot;</span><span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span> 
<span class="token punctuation">}</span> 

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fun</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//调用函数1 </span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 输出1</span>
</code></pre></div><p>错误情况</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span> <span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 此时编译器无法区分</span>
</code></pre></div><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20221012151329534.png" alt="image-20221012151329534"> <p>出现二义性错误</p></li></ul> <blockquote><p>关于函数名修饰，详情参看博客 ：<a href="https://www.cnblogs.com/Pigern-jun/p/15758144.html" target="_blank" rel="noopener noreferrer">C++基础之函数重载<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <p><strong>Linux下函数重载修饰的规则：</strong></p> <p>从代码到程序经过<strong>预处理，编译，汇编，链接</strong>几个过程，C++为了支持函数重载在编译阶段对函数名做了修饰，即名字修饰。Windows下修饰比较复杂，Linux下修饰比较容易。</p> <blockquote><p>_Z+函数名长度+函数名+形参类型
形参类型：
i int
f float
c char
pi *int
其它照此类推</p></blockquote> <h2 id="c-primer部分内容"><a href="#c-primer部分内容" class="header-anchor">#</a> C++Primer部分内容</h2> <h3 id="_5-顺序容器"><a href="#_5-顺序容器" class="header-anchor">#</a> 5 顺序容器</h3> <h4 id="_5-1-额外的string操作"><a href="#_5-1-额外的string操作" class="header-anchor">#</a> 5.1 额外的string操作</h4> <p><img src="https://feobay.oss-cn-shanghai.aliyuncs.com/img/image-20220610164909546.png" alt="image-20220610164909546"></p> <p>可能的原因：</p> <p>我想了一下，可能是由于没有空字符结束，所以这里就直接在字面值常量存放的内存区域（.rodata）中拷贝，直到遇到第一个空字符'\0'就结束拷贝，而之所以为&quot;HiHello World!!!&quot;是因为&quot;Hi&quot;是.rodata段已被使用空间的末尾，然后偏移量指针就回到(.rodata段的)开头继续向后遍历拷贝直到遇到第一个'\0'</p> <h3 id="io库"><a href="#io库" class="header-anchor">#</a> IO库</h3> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;csdtio&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
cout <span class="token operator">&lt;&lt;</span> <span class="token number">3</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span> <span class="token comment">// endl输出一个换行换行刷新缓冲区</span>
cout <span class="token operator">&lt;&lt;</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> ends<span class="token punctuation">;</span> <span class="token comment">// ends向缓冲区插入一个空字符，然后刷新缓冲区</span>
cout <span class="token operator">&lt;&lt;</span> <span class="token number">2</span> <span class="token operator">&lt;&lt;</span> flush<span class="token punctuation">;</span> <span class="token comment">// flush刷新缓冲区，但不输出任何额外字符</span>
</code></pre></div><h2 id="补充"><a href="#补充" class="header-anchor">#</a> 补充</h2> <h3 id="关于extern关键字"><a href="#关于extern关键字" class="header-anchor">#</a> 关于extern关键字</h3> <p>具体可以参考文章 <a href="https://www.cnblogs.com/honernan/p/13431431.html" target="_blank" rel="noopener noreferrer">extern关键字的作用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>凡是没有带extern的声明同时也都是定义</strong></p> <p>extern的三种用法</p> <p><strong>非常量全局变量的外部链接</strong></p> <p>最常见的用法，当链接器在一个全局变量声明前看到extern关键字，它会尝试在其他文件中寻找这个变量的定义。这里强调全局且非常量的原因是，全局非常量的变量默认是外部链接的。</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">//fileA.cpp</span>
<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>         <span class="token comment">//声明并定义全局变量i</span>

<span class="token comment">//fileB.cpp</span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>    <span class="token comment">//声明i，链接全局变量</span>

<span class="token comment">//fileC.cpp</span>
<span class="token keyword">extern</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>        <span class="token comment">//错误，多重定义</span>
<span class="token keyword">int</span> i<span class="token punctuation">;</span>                    <span class="token comment">//错误，这是一个定义，导致多重定义</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">extern</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>        <span class="token comment">//正确</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>            <span class="token comment">//正确，新的局部变量i;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>常量全局变量的外部链接</strong></p> <p>常量全局变量默认是内部链接的，所以想要在文件间传递常量全局变量需要在定义时指明extern，如下所示：</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">//fileA.cpp</span>
<span class="token keyword">extern</span> <span class="token keyword">const</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token comment">//定义</span>

<span class="token comment">//fileB.cpp                    //声明</span>
<span class="token keyword">extern</span> <span class="token keyword">const</span> <span class="token keyword">int</span> i<span class="token punctuation">;</span>
</code></pre></div><p><strong>extern &quot;C&quot; 和extern &quot;C++&quot;函数声明</strong></p> <p>在C++中，当与字符串连用时，extern指明当前声明使用了其他语言的链接规范，如extern &quot;C&quot;，就指明使用C语言的链接规范。原因是，C++语言在编译的时候为了解决函数的多态问题，会将函数名和参数联合起来生成一个中间的函数名称，而C语言则不会，因此会造成链接时无法找到对应函数的情况，此时C函数就需要用extern “C”进行链接指定，这告诉编译器，请保持我的名称，不要给我生成用于链接的中间函数名。C和C++对函数的处理方式是不同的.extern &quot;C&quot;是使C++能够调用C写作的库文件的一个手段，如果要对编译器提示使用C的方式来处理函数的话，那么就要使用extern &quot;C&quot;来说明。</p> <p>示例：</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">// 声明printf函数使用C链接</span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token keyword">int</span> <span class="token function">printf</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>fmt<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">//声明指定的头文件内所有的东西都使用 C 链接</span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token punctuation">}</span>

<span class="token comment">//  声明函数ShowChar和GetChar使用 C 链接</span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token punctuation">{</span>
    <span class="token keyword">char</span> <span class="token function">ShowChar</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">char</span> <span class="token function">GetChar</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//  定义函数 ShowChar 和 GetChar 使用 C 链接</span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token keyword">char</span> <span class="token function">ShowChar</span><span class="token punctuation">(</span><span class="token keyword">char</span> ch<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">putchar</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ch<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token keyword">char</span> <span class="token function">GetChar</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">char</span> ch<span class="token punctuation">;</span>
    ch <span class="token operator">=</span> <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ch<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 声明全局变量 errno 为C链接</span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token keyword">int</span> errno<span class="token punctuation">;</span>

<span class="token comment">//又比如，在程序中常见的代码段</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus  </span></span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token punctuation">{</span>  
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span>  </span>
  
<span class="token comment">/**** some declaration or so *****/</span>  
  
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus  </span></span>
<span class="token punctuation">}</span>  
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

<span class="token comment">//这里__cplusplus是cpp中的自定义宏，定义了这个宏就表明这是一段cpp的代码，也就是说，</span>
<span class="token comment">//上面的代码的含义是:如果这是一段cpp的代码，那么加入extern &quot;C&quot;{和}处理其中的代码。</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/cs-basis/" class="prev router-link-active">
        计算机基础
      </a></span> <span class="next"><a href="/cs-basis/2_EffectiveC++.html">
        EffectiveC++
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.72c8bf2a.js" defer></script><script src="/assets/js/2.2702b4bf.js" defer></script><script src="/assets/js/13.b6a9667b.js" defer></script>
  </body>
</html>
